.river {
  height: 100%;
  overflow: auto;
  scroll-snap-type: y proximity;
  overscroll-behavior-y: contain;
  /* Force Paint Containment at Section Level */
  /* Reduces style recalculation fan-out during Phase-2 */
  contain: layout style paint;
}
.river__pad {
  padding: calc(var(--safe-top) + var(--s-2)) var(--s-3) calc(var(--component-bottom-offset) + var(--safe-bot));
  display: flex;
  flex-direction: column;
  gap: var(--s-3);
}
.river__panel {
  border-radius: var(--r-4);
}
.river__panelTitle {
  font-size: var(--fs-3);
}
.river__panelText {
  font-size: var(--fs-2);
}
.river__end {
  text-align: center;
  padding: var(--s-3) 0 var(--s-4);
}
.riverCard {
  scroll-snap-align: center;
  border-radius: var(--r-4);
  overflow: hidden;
  min-height: 80vh;
  position: relative;
  box-shadow: var(--shadow-2);
  border: 1px solid var(--component-border-subtle);
  background: #0b0b10;
  /* Use content-visibility: auto aggressively for below-the-fold cards */
  /* Browser skips layout, paint, style until needed - huge for long feeds */
  content-visibility: auto;
  contain-intrinsic-size: 600px;
  margin: var(--s-10) auto;
}
/* First card (position 0) should NOT use content-visibility */
.riverCard:first-child {
  content-visibility: visible;
  contain-intrinsic-size: auto;
}
.riverCard--skeleton {
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid var(--component-border-extra-subtle);
}
.riverCard--static {
  cursor: default;
}
.riverCard--noMedia {
  background: var(--bg-secondary);
}
.riverCard--noMedia .riverCard__meta {
  justify-content: center;
  height: 100%;
}
.riverCard--noMedia .riverCard__meta > .u-stack {
  justify-content: center;
  height: 100%;
}
.riverCard--noMedia .riverCard__question {
  flex: 1;
  justify-content: center;
  max-width: 100%;
}
.riverCard__media {
  position: absolute;
  inset: 0;
  touch-action: pan-y;
}
.riverCard__mediaFrame {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: stretch;
  justify-content: center;
  overflow: hidden;
}
.riverCard__mediaEmpty {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  text-align: center;
  color: rgba(255, 255, 255, 0.75);
  text-shadow: 0 8px 18px rgba(0, 0, 0, 0.4);
  font-size: var(--fs-3);
  letter-spacing: 0.02em;
}
.riverCard__mediaEmptyLabel {
  padding: var(--s-3);
}
.riverCard__mediaItem {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transform: scale(1.02);
  filter: saturate(1.06) contrast(1.05);
}
.riverCard__mediaEmbed {
  width: 100%;
  height: 100%;
}
.riverCard__mediaItem--error {
  display: grid;
  place-items: center;
  background: rgba(0, 0, 0, 0.3);
  color: rgba(255, 255, 255, 0.5);
}
.riverCard__videoContainer {
  position: relative;
  width: 100%;
  height: 100%;
}
.riverCard__videoControls {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  pointer-events: none;
  z-index: var(--z-overlay);
  opacity: 0;
  transition: opacity 0.3s ease;
}
.riverCard__videoControls--visible {
  opacity: 1;
  pointer-events: auto;
}
.riverCard__videoPlayBtn {
  width: var(--component-size-play-btn);
  height: var(--component-size-play-btn);
  border-radius: 999px;
  border: 2px solid rgba(255, 255, 255, 0.3);
  background: var(--component-surface-strong);
  backdrop-filter: blur(8px);
  color: #fff;
  display: grid;
  place-items: center;
  cursor: pointer;
  min-width: var(--component-size-touch);
  min-height: var(--component-size-touch);
  transition:
    transform 0.12s ease,
    background 0.12s ease,
    border-color 0.12s ease;
  pointer-events: auto;
}
.riverCard__videoPlayBtn:hover {
  background: rgba(0, 0, 0, 0.75);
  border-color: rgba(255, 255, 255, 0.5);
}
.riverCard__videoPlayBtn:active {
  transform: scale(0.95);
}
.riverCard__adLabel {
  display: flex;
  gap: var(--s-2);
  margin-bottom: var(--s-2);
}
.riverCard__mediaMosaic {
  position: absolute;
  inset: 0;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  grid-template-rows: repeat(2, minmax(0, 1fr));
  gap: var(--s-2);
  padding: var(--s-2);
}
.riverCard__mediaNav {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--s-2);
  pointer-events: none;
  z-index: 999999999999;
}
.riverCard__mediaBtn {
  width: 22px;
  max-width: 22px;
  height: 64px;
  border-radius: 999px;
  border: 1px solid var(--component-border-strong);
  background: var(--overlay-medium);
  color: var(--text);
  display: grid;
  place-items: center;
  cursor: pointer;
  pointer-events: auto;
  transition:
    transform 0.12s ease,
    border-color 0.12s ease,
    background 0.12s ease;
}
.riverCard__mediaBtn:active {
  transform: scale(0.96);
}
.riverCard__mediaRetryBtn {
  padding: var(--s-2) var(--s-4);
  border-radius: var(--r-2);
  border: 1px solid rgba(255, 255, 255, 0.3);
  background: var(--component-surface-strong);
  color: #fff;
  cursor: pointer;
  margin-top: var(--s-4);
  transition: background 0.12s ease;
}
.riverCard__mediaRetryBtn:hover {
  background: rgba(0, 0, 0, 0.8);
}
.riverCard__mediaMosaic--empty {
  display: flex;
  align-items: center;
  justify-content: center;
}
.riverCard__videoPoster {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  pointer-events: none;
}
.riverCard__meta {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  gap: var(--s-3);
  z-index: 110;
  pointer-events: none;
}
.riverCard__meta > .u-stack { 
  width: 100%;
  pointer-events: auto;
}
/* When comments are open, expand meta to 80% and push media up */
.riverCard--commentsOpen .riverCard__media {
  height: 20%;
  top: 0;
  bottom: auto;
}
.riverCard--commentsOpen .riverCard__meta {
  height: 80%;
}
.riverCard--commentsOpen .riverCard__meta > .u-stack {
  height: 100%;
}
.riverCard__name {
  display: flex;
  align-items: flex-end;
  gap: var(--s-2);
}
.riverCard__nameButton {
  /* Reset button styles */
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  text-align: inherit;
  font: inherit;
  color: inherit;
  cursor: pointer;
  /* Add transition for hover effect */
  transition: opacity 0.2s ease;
}
.riverCard__nameButton:hover {
  opacity: 0.85;
}
.riverCard__nameButton:active {
  opacity: 0.7;
}
.riverCard__avatar {
  flex-shrink: 0;
}
.riverCard__name h2 {
  margin: 0;
  font-size: var(--fs-6);
  line-height: var(--lh-tight);
  letter-spacing: -0.02em;
  text-shadow: 0 6px 18px rgba(0, 0, 0, 0.55);
  font-weight: 700;
}
.riverCard__name span {
  font-size: var(--fs-4);
  color: rgba(255, 255, 255, 0.8);
  text-shadow: 0 6px 18px rgba(0, 0, 0, 0.55);
  opacity: 0.9;
  font-weight: 500;
}
.riverCard__chips {
  display: flex;
  flex-wrap: wrap;
  gap: var(--s-2);
}
.riverCard__description {
  color: rgba(255, 255, 255, 0.84);
  font-size: var(--fs-3);
  line-height: var(--lh-normal);
  text-shadow: 0 8px 18px rgba(0, 0, 0, 0.55);
}
.riverCard__actions {
  display: flex;
  gap: var(--s-3);
  align-items: center;
}
.riverCard__engagement {
  display: flex;
  flex-wrap: wrap;
  gap: var(--s-2);
  align-items: center;
}
.riverCard__stat {
  padding: var(--s-1) var(--s-2);
  border-radius: 999px;
  border: 1px solid var(--component-border-soft);
  background: var(--overlay-medium);
  font-size: var(--fs-2);
  color: var(--muted);
}
.riverCard__hint {
  font-size: var(--fs-2);
}
.riverCard__comments {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: var(--s-1);
  padding: var(--s-2);
  border-radius: var(--r-12);
  background: var(--overlay-medium);
  border: 1px solid var(--component-border);
  pointer-events: auto;
  overflow: hidden;
}
.riverCard__commentsContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow-y: auto;
  overflow-x: hidden;
  min-height: 0;
  /* Scroll to bottom by default */
  scroll-behavior: smooth;
}
.riverCard__commentsList {
  display: flex;
  flex-direction: column;
  gap: var(--s-1);
  /* Push content to bottom */
  margin-top: auto;
  padding-top: var(--s-2);
}
.riverCard__commentsLabel {
  font-size: var(--fs-1);
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--muted);
  flex-shrink: 0;
}
.riverCard__comment {
  font-size: var(--fs-2);
  color: rgba(255, 255, 255, 0.86);
  flex-shrink: 0;
}
.riverCard__comment--pending {
  opacity: 0.6;
}
.riverCard__commentComposer {
  display: flex;
  gap: var(--s-2);
  margin-top: var(--s-1);
  flex-shrink: 0;
}
.riverCard__commentInput {
  flex: 1;
  height: var(--component-height-input);
  border-radius: var(--r-1);
  border: 1px solid var(--component-border);
  background: var(--overlay-medium);
  color: var(--text);
  padding: 0 var(--s-2);
  font-size: var(--fs-2);
}
.riverCard__commentInput:focus {
  outline: none;
  border-color: rgba(59, 130, 246, 0.45);
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
}
.riverCard__commentSubmit {
  height: var(--component-height-input);
  padding: 0 var(--s-3);
  border-radius: var(--r-1);
  border: 1px solid rgba(59, 130, 246, 0.35);
  background: rgba(59, 130, 246, 0.18);
  color: var(--text);
  cursor: pointer;
  font-size: var(--fs-2);
}
.riverCard__question {
  display: flex;
  flex-direction: column;
  gap: var(--s-2);
  padding: var(--s-3);
  border-radius: var(--r-16);
  background: var(--overlay-medium);
  border: 1px solid var(--component-border-soft);
}
.riverCard__questionPrompt {
  font-size: var(--fs-3);
  font-weight: 600;
  height: 50%;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}
.riverCard__questionOptions {
  display: grid;
  gap: var(--s-2);
}
.riverCard__questionOption {
  padding: var(--s-2) var(--s-3);
  border-radius: var(--r-12);
  border: 1px solid var(--component-border-soft);
  background: var(--overlay-medium);
  color: var(--text);
  text-align: left;
  cursor: pointer;
}
.riverCard__questionOption:active {
  transform: scale(0.99);
}
.riverCard__questionOption--active {
  border-color: rgba(59, 130, 246, 0.55);
  background: rgba(59, 130, 246, 0.22);
}
.riverCard__shimmer {
  position: absolute;
  inset: 0;
  opacity: 0.4;
  transform: translateX(-40%);
  animation: riverShimmer 1.2s infinite;
}
@keyframes riverShimmer {
  0% {
    transform: translateX(-40%);
  }
  100% {
    transform: translateX(40%);
  }
}

/* Import comment styles */
@import './comments.css';
